
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "gallery/07-observer/az_el_parallel.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_gallery_07-observer_az_el_parallel.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_gallery_07-observer_az_el_parallel.py:


Azimuth/Elevation Conversion
============================

Given a station and a target in inertial space we can compute the azimuth and elevation of the object, or invert an azimuth and elevation into a new look direction

.. GENERATED FROM PYTHON SOURCE LINES 7-14

.. code-block:: default


    import numpy as np
    import pyvista as pv

    import mirage as mr
    import mirage.vis as mrv








.. GENERATED FROM PYTHON SOURCE LINES 15-16

Let's use the Purdue Optical Ground Station for this example

.. GENERATED FROM PYTHON SOURCE LINES 16-20

.. code-block:: default

    station = mr.Station(preset="pogs")
    dt0 = mr.utc(2023, 8, 13)
    dates = mr.date_linspace(dt0, dt0 + mr.days(1), int(1e4))








.. GENERATED FROM PYTHON SOURCE LINES 21-22

Let's extract the station's position in J2000 and create an ECI look direction which is just outwards and down towards the equator

.. GENERATED FROM PYTHON SOURCE LINES 22-30

.. code-block:: default

    station_j2k = station.j2000_at_dates(dates)

    eci_pos = station_j2k * 2
    eci_pos[:, -1] = 0

    target_dir_eci = mr.hat(eci_pos - station_j2k)









.. GENERATED FROM PYTHON SOURCE LINES 31-32

We can then turn this target direction into an azimuth/elevation pair

.. GENERATED FROM PYTHON SOURCE LINES 32-36

.. code-block:: default

    az, el = station.eci_to_az_el(dates, target_dir_eci)
    print(f"{az[0]=} [rad]")
    print(f"{el[0]=} [rad]")





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    az[0]=3.140058391115783 [rad]
    el[0]=0.421665598724193 [rad]




.. GENERATED FROM PYTHON SOURCE LINES 37-38

And easily invert that into the same unit vector direction

.. GENERATED FROM PYTHON SOURCE LINES 38-43

.. code-block:: default

    eci_hat = station.az_el_to_eci(az, el, dates)
    print(
        f"ECI vector reconstruction error: {np.linalg.norm(target_dir_eci[0,:] - eci_hat[0,:])}"
    )





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    ECI vector reconstruction error: 2.7755575615628914e-16




.. GENERATED FROM PYTHON SOURCE LINES 44-45

We can also display this resulting unit vector as a ray cast out from the observer, hitting the target

.. GENERATED FROM PYTHON SOURCE LINES 45-66

.. code-block:: default

    pl = pv.Plotter()
    stat_origin0 = station.j2000_at_dates(dates[0])
    mrv.plot_earth(pl, date=dates[0], high_def=True, atmosphere=False, borders=True)
    rotm = mr.EarthFixedFrame("itrf", "j2000").rotms_at_dates(dates[0]) @ mr.enu_to_ecef(
        station.itrf
    )
    mrv.plot_basis(
        pl, rotm, labels=["E", "N", "U"], origin=stat_origin0, scale=1000, color="linen"
    )
    mrv.plot_arrow(
        pl,
        origin=stat_origin0,
        direction=eci_hat[0, :],
        scale=1000,
        color="c",
        label="To object",
    )
    pl.camera.focal_point = stat_origin0
    pl.camera.position = np.array(pl.camera.focal_point) + 10 * np.array([-500, -200, 200])
    print(pl.camera.focal_point)
    pl.show()



.. image-sg:: /gallery/07-observer/images/sphx_glr_az_el_parallel_001.png
   :alt: az el parallel
   :srcset: /gallery/07-observer/images/sphx_glr_az_el_parallel_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    /Users/liamrobinson/Documents/PyLightCurves/lib/python3.10/site-packages/pyvista/core/dataset.py:595: PyVistaDeprecationWarning: Use of `DataSet.active_t_coords` is deprecated. Use `DataSet.active_texture_coordinates` instead.
      warnings.warn(
    /Users/liamrobinson/Documents/PyLightCurves/lib/python3.10/site-packages/pyvista/core/dataset.py:580: PyVistaDeprecationWarning: Use of `DataSet.active_t_coords` is deprecated. Use `DataSet.active_texture_coordinates` instead.
      warnings.warn(
    (-4364.86646948316, -3100.5831618753564, 3454.743622623403)





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  14.723 seconds)


.. _sphx_glr_download_gallery_07-observer_az_el_parallel.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example




    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: az_el_parallel.py <az_el_parallel.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: az_el_parallel.ipynb <az_el_parallel.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
