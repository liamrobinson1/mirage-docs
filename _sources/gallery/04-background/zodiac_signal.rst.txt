
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "gallery/04-background/zodiac_signal.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_gallery_04-background_zodiac_signal.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_gallery_04-background_zodiac_signal.py:


Zodiac Signal
=============

The background signal model due to zodiac light

.. GENERATED FROM PYTHON SOURCE LINES 7-55



.. image-sg:: /gallery/04-background/images/sphx_glr_zodiac_signal_001.png
   :alt: zodiac signal
   :srcset: /gallery/04-background/images/sphx_glr_zodiac_signal_001.png
   :class: sphx-glr-single-img





.. code-block:: default


    import pyspaceaware as ps
    import numpy as np
    import pyvista as pv

    pl = pv.Plotter()
    station = ps.Station()
    date = ps.now() + ps.hours(8)
    station_pos_eci = station.eci_at_dates(date)
    (g_az, g_el) = np.meshgrid(
        np.linspace(0, 2 * np.pi, 200),
        np.linspace(0.1, np.pi / 2 - 0.1, 200),
    )

    look_dirs_eci_eq = np.array(
        [
            station.az_el_to_eci(az, el, date)
            for az, el in zip(g_az.flatten(), g_el.flatten())
        ]
    ).squeeze()

    obs_pos_eci_eq = np.tile(station_pos_eci, (g_az.size, 1))
    dates = np.tile(date, (g_az.size, 1))
    sz = ps.zodiacal_signal(
        dates,
        look_dirs_eci_eq,
        obs_pos_eci_eq,
        t_int=station.telescope.integration_time,
        scale=station.telescope.pixel_scale,
        d=station.telescope.aperture_diameter,
    )
    sz = np.reshape(sz, g_el.shape, order="f")

    ps.scatter3(
        pl,
        look_dirs_eci_eq,
        scalars=sz.T.flatten(),
        cmap="plasma",
        point_size=10,
    )
    ps.scatter3(
        pl,
        ps.hat(ps.sun(ps.date_to_jd(dates.flatten()))),
        color="yellow",
        point_size=50,
    )
    ps.two_sphere(pl)
    pl.show()


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  7.836 seconds)


.. _sphx_glr_download_gallery_04-background_zodiac_signal.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example




    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: zodiac_signal.py <zodiac_signal.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: zodiac_signal.ipynb <zodiac_signal.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
