
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "gallery/04-background/background_signals.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_gallery_04-background_background_signals.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_gallery_04-background_background_signals.py:


Background Signals
==================

The signal mean model due to various sources

.. GENERATED FROM PYTHON SOURCE LINES 9-10

Defining a function we can use to plot various background signals

.. GENERATED FROM PYTHON SOURCE LINES 10-68

.. code-block:: default


    import pyspaceaware as ps
    import numpy as np
    import pyvista as pv
    import datetime


    def hemisphere_signal(
        station: ps.Station, date: datetime.datetime, signal_kwargs: dict
    ) -> None:
        pl = pv.Plotter()
        (g_az, g_el) = np.meshgrid(
            np.linspace(0, 2 * np.pi, 250),
            np.linspace(np.deg2rad(10), np.pi / 2, 250),
        )

        look_dirs_eci_eq = np.array(
            [
                station.az_el_to_eci(az, el, date)
                for az, el in zip(g_az.flatten(), g_el.flatten())
            ]
        ).squeeze()

        dates = np.tile(date, (g_az.size, 1))
        stat_eci = station.eci_at_dates(date)

        ps.tic()
        sb = station.sky_brightness(
            dates, look_dirs_eci_eq, **signal_kwargs
        )
        ps.toc()
        ps.plot_earth(
            pl,
            date=date,
            atmosphere=False,
            lighting=True,
            night_lights=True,
        )
        r_dome = 500  # km
        view_dist = 40e3  # km
        zoom = 3.5
        ps.scatter3(
            pl,
            stat_eci + r_dome * look_dirs_eci_eq,
            scalars=sb.flatten(),
            cmap="hot",
            point_size=10,
            lighting=False,
            clim=[0, np.max(sb)],
        )

        pl.camera.focal_point = stat_eci.flatten()
        cpos = (stat_eci + ps.hat(stat_eci) * view_dist).flatten()
        pl.camera.position = cpos
        pl.camera.zoom(zoom)
        pl.show()









.. GENERATED FROM PYTHON SOURCE LINES 69-70

Setting up observation conditions using an example Liquid Mirror Telescope preset

.. GENERATED FROM PYTHON SOURCE LINES 70-75

.. code-block:: default

    station = ps.Station(preset="lmt")
    date = datetime.datetime(
        2023, 10, 1, 5, 45, 0, tzinfo=datetime.timezone.utc
    )  # Fig 5.38








.. GENERATED FROM PYTHON SOURCE LINES 76-77

Plotting the background signal for scattered moonlight

.. GENERATED FROM PYTHON SOURCE LINES 77-86

.. code-block:: default

    signal_kwargs = {
        "atmos_scattered": False,
        "moonlight": True,
        "airglow": False,
        "integrated_starlight": False,
        "zodiac": False,
    }
    hemisphere_signal(station, date, signal_kwargs)




.. image-sg:: /gallery/04-background/images/sphx_glr_background_signals_001.png
   :alt: background signals
   :srcset: /gallery/04-background/images/sphx_glr_background_signals_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Elapsed time: 6.18e+00 seconds




.. GENERATED FROM PYTHON SOURCE LINES 87-88

Plotting the background signal for integrated starlight

.. GENERATED FROM PYTHON SOURCE LINES 88-97

.. code-block:: default

    signal_kwargs = {
        "atmos_scattered": False,
        "moonlight": False,
        "airglow": False,
        "integrated_starlight": True,
        "zodiac": False,
    }
    hemisphere_signal(station, date, signal_kwargs)




.. image-sg:: /gallery/04-background/images/sphx_glr_background_signals_002.png
   :alt: background signals
   :srcset: /gallery/04-background/images/sphx_glr_background_signals_002.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    [6.11257857 6.14913948 6.18563433 ... 6.11257857 6.11257857 6.11257857] [-0.82372718 -0.82333945 -0.82217745 ...  0.57253622  0.57253622
      0.57253622]
    Elapsed time: 4.48e+00 seconds




.. GENERATED FROM PYTHON SOURCE LINES 98-99

Plotting the background signal for zodiac light

.. GENERATED FROM PYTHON SOURCE LINES 99-108

.. code-block:: default

    signal_kwargs = {
        "atmos_scattered": False,
        "moonlight": False,
        "airglow": False,
        "integrated_starlight": False,
        "zodiac": True,
    }
    hemisphere_signal(station, date, signal_kwargs)




.. image-sg:: /gallery/04-background/images/sphx_glr_background_signals_003.png
   :alt: background signals
   :srcset: /gallery/04-background/images/sphx_glr_background_signals_003.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Elapsed time: 5.23e+00 seconds




.. GENERATED FROM PYTHON SOURCE LINES 109-110

Plotting the background signal for airglow

.. GENERATED FROM PYTHON SOURCE LINES 110-119

.. code-block:: default

    signal_kwargs = {
        "atmos_scattered": False,
        "moonlight": False,
        "airglow": True,
        "integrated_starlight": False,
        "zodiac": False,
    }
    hemisphere_signal(station, date, signal_kwargs)




.. image-sg:: /gallery/04-background/images/sphx_glr_background_signals_004.png
   :alt: background signals
   :srcset: /gallery/04-background/images/sphx_glr_background_signals_004.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Elapsed time: 4.39e+00 seconds




.. GENERATED FROM PYTHON SOURCE LINES 120-121

Plotting the background signal for atmospherically scattered light

.. GENERATED FROM PYTHON SOURCE LINES 121-129

.. code-block:: default

    signal_kwargs = {
        "atmos_scattered": True,
        "moonlight": False,
        "airglow": False,
        "integrated_starlight": False,
        "zodiac": False,
    }
    hemisphere_signal(station, date, signal_kwargs)



.. image-sg:: /gallery/04-background/images/sphx_glr_background_signals_005.png
   :alt: background signals
   :srcset: /gallery/04-background/images/sphx_glr_background_signals_005.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Elapsed time: 4.33e+00 seconds





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 1 minutes  5.918 seconds)


.. _sphx_glr_download_gallery_04-background_background_signals.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example




    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: background_signals.py <background_signals.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: background_signals.ipynb <background_signals.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
