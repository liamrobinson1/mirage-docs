
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "gallery/03-coordinate-systems/earth_pole_motion.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_gallery_03-coordinate-systems_earth_pole_motion.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_gallery_03-coordinate-systems_earth_pole_motion.py:


Precession and Nutation
=======================

Viewing the evolution of the terrestrial

.. GENERATED FROM PYTHON SOURCE LINES 7-13

.. code-block:: default


    import numpy as np
    import pyvista as pv

    import pyspaceaware as ps








.. GENERATED FROM PYTHON SOURCE LINES 14-15

Let's use the full range of the datetime module, from near year 0 to near year 9999

.. GENERATED FROM PYTHON SOURCE LINES 15-20

.. code-block:: default

    date0 = ps.utc(2023, 12, 9) - ps.years(2020)
    dates, ep = ps.date_linspace(
        date0, date0 + ps.years(9990), int(1e5), return_epsecs=True
    )








.. GENERATED FROM PYTHON SOURCE LINES 21-22

We then transform the true terrestrial pole in TOD to J2000 to look at the effect of precession and nutation with respect to the J2000 epoch

.. GENERATED FROM PYTHON SOURCE LINES 22-29

.. code-block:: default

    pole_nominal = np.tile(
        np.array([[0, 0, ps.AstroConstants.earth_r_eq * 1.3]]), (dates.size, 1)
    )
    ps.tic()
    pole_instant = ps.EarthFixedFrame("tod", "j2000").vecs_at_dates(dates, pole_nominal)
    ps.toc()





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    /Users/liamrobinson/Documents/PyLightCurves/lib/python3.10/site-packages/erfa/core.py:154: ErfaWarning: ERFA function "dtf2d" yielded 99329 of "dubious year (Note 6)"
      warnings.warn('ERFA function "{}" yielded {}'.format(func_name, wmsg),
    /Users/liamrobinson/Documents/PyLightCurves/lib/python3.10/site-packages/erfa/core.py:154: ErfaWarning: ERFA function "utctai" yielded 99329 of "dubious year (Note 3)"
      warnings.warn('ERFA function "{}" yielded {}'.format(func_name, wmsg),
    Elapsed time: 2.05e+00 seconds




.. GENERATED FROM PYTHON SOURCE LINES 30-31

We can view this data from a distance to view precession

.. GENERATED FROM PYTHON SOURCE LINES 31-39

.. code-block:: default

    pl = pv.Plotter()
    ps.plot_earth(pl, lighting=False, high_def=True)
    ps.scatter3(pl, pole_instant, point_size=10)
    pl.camera.focal_point = np.mean(pole_instant, axis=0)
    pl.camera.position = 6 * pole_nominal[0, :] + np.array([1e-4, 1e-4, 0])
    pl.show()





.. image-sg:: /gallery/03-coordinate-systems/images/sphx_glr_earth_pole_motion_001.png
   :alt: earth pole motion
   :srcset: /gallery/03-coordinate-systems/images/sphx_glr_earth_pole_motion_001.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 40-41

And from close up to show nutation

.. GENERATED FROM PYTHON SOURCE LINES 41-50

.. code-block:: default

    z = 20
    pl = pv.Plotter()
    ps.plot_earth(pl, lighting=False, high_def=True)
    ps.plot3(pl, pole_instant, line_width=10, color="m")
    pl.camera.focal_point = pole_instant[0, :]
    pl.camera.position = pole_instant[0, :] + np.array([1e-2, 1e-2, 25_000 / z])
    pl.camera.zoom(z)
    pl.show()




.. image-sg:: /gallery/03-coordinate-systems/images/sphx_glr_earth_pole_motion_002.png
   :alt: earth pole motion
   :srcset: /gallery/03-coordinate-systems/images/sphx_glr_earth_pole_motion_002.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 51-52

Animating a full zoom sequence

.. GENERATED FROM PYTHON SOURCE LINES 52-64

.. code-block:: default


    pl = pv.Plotter()
    pl.open_gif("precession_nutation_zoom.gif")
    ps.plot_earth(pl, lighting=False, high_def=True)
    ps.plot3(pl, pole_instant, line_width=10, color="m")
    for z in np.logspace(-10, 30, 50, base=1.2):
        pl.camera = pv.Camera()
        pl.camera.focal_point = pole_instant[0, :]
        pl.camera.position = pole_instant[0, :] + np.array([1e-2, 1e-2, 2_000])
        pl.camera.zoom(z)
        pl.write_frame()
    pl.close()



.. image-sg:: /gallery/03-coordinate-systems/images/sphx_glr_earth_pole_motion_003.png
   :alt: earth pole motion
   :srcset: /gallery/03-coordinate-systems/images/sphx_glr_earth_pole_motion_003.png
   :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  39.182 seconds)


.. _sphx_glr_download_gallery_03-coordinate-systems_earth_pole_motion.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example




    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: earth_pole_motion.py <earth_pole_motion.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: earth_pole_motion.ipynb <earth_pole_motion.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
